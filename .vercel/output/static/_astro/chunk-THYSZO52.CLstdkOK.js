var N=(e,n,r)=>!e&&r?V(r):D(n),V=e=>{const n=e.userId,r=e.user,s=e.sessionId,o=e.session,i=e.organization,l=e.orgId,v=e.orgRole,a=e.orgPermissions,g=e.orgSlug,c=e.actor,t=e.__experimental_factorVerificationAge;return{userId:n,user:r,sessionId:s,session:o,organization:i,orgId:l,orgRole:v,orgPermissions:a,orgSlug:g,actor:c,__experimental_factorVerificationAge:t}},D=e=>{var n;const r=e.user?e.user.id:e.user,s=e.user,o=e.session?e.session.id:e.session,i=e.session,l=e.session?e.session.__experimental_factorVerificationAge:null,v=i?.actor,a=e.organization,g=e.organization?e.organization.id:e.organization,c=a?.slug,t=a&&((n=s?.organizationMemberships)==null?void 0:n.find(R=>R.organization.id===g)),p=t&&t.permissions,O=t&&t.role;return{userId:r,user:s,sessionId:o,session:i,organization:a,orgId:g,orgRole:O,orgSlug:c,orgPermissions:p,actor:v,__experimental_factorVerificationAge:l}},C="METHOD_CALLED";function P(e,n){return{event:C,payload:{method:e,...n}}}let u=[],f=0;const m=4;let E=0,I=e=>{let n=[],r={get(){return r.lc||r.listen(()=>{})(),r.value},lc:0,listen(s){return r.lc=n.push(s),()=>{for(let i=f+m;i<u.length;)u[i]===s?u.splice(i,m):i+=m;let o=n.indexOf(s);~o&&(n.splice(o,1),--r.lc||r.off())}},notify(s,o){E++;let i=!u.length;for(let l of n)u.push(l,r.value,s,o);if(i){for(f=0;f<u.length;f+=m)u[f](u[f+1],u[f+2],u[f+3]);u.length=0}},off(){},set(s){let o=r.value;o!==s&&(r.value=s,r.notify(o))},subscribe(s){let o=r.listen(s);return s(r.value),o},value:e};return r};const Q=5,_=6,h=10;let F=(e,n,r,s)=>(e.events=e.events||{},e.events[r+h]||(e.events[r+h]=s(o=>{e.events[r].reduceRight((i,l)=>(l(i),i),{shared:{},...o})})),e.events[r]=e.events[r]||[],e.events[r].push(n),()=>{let o=e.events[r],i=o.indexOf(n);o.splice(i,1),o.length||(delete e.events[r],e.events[r+h](),delete e.events[r+h])}),H=1e3,A=(e,n)=>F(e,s=>{let o=n(s);o&&e.events[_].push(o)},Q,s=>{let o=e.listen;e.listen=(...l)=>(!e.lc&&!e.active&&(e.active=!0,s()),o(...l));let i=e.off;return e.events[_]=[],e.off=()=>{i(),setTimeout(()=>{if(e.active&&!e.lc){e.active=!1;for(let l of e.events[_])l();e.events[_]=[]}},H)},()=>{e.listen=o,e.off=i}}),M=(e,n,r)=>{Array.isArray(e)||(e=[e]);let s,o,i=()=>{if(o===E)return;o=E;let c=e.map(t=>t.get());if(!s||c.some((t,p)=>t!==s[p])){s=c;let t=n(...c);t&&t.then&&t.t?t.then(p=>{s===c&&l.set(p)}):(l.set(t),o=E)}},l=I(void 0),v=l.get;l.get=()=>(i(),v());let a,g=r?()=>{clearTimeout(a),a=setTimeout(i)}:i;return A(l,()=>{let c=e.map(t=>t.listen(g));return i(),()=>{for(let t of c)t()}}),l},d=(e,n)=>M(e,n),$=(e,n)=>M(e,n,!0),U=(e={})=>{let n=I(e);return n.setKey=function(r,s){let o=n.value;typeof s>"u"&&r in n.value?(n.value={...n.value},delete n.value[r],n.notify(o,r)):n.value[r]!==s&&(n.value={...n.value,[r]:s},n.notify(o,r))},n};var T=U({isLoaded:!1,client:void 0,user:void 0,session:void 0,organization:void 0}),q=U(),x=I(null),J=d([T],e=>e.isLoaded),z=$([T,q],(e,n)=>N(e.isLoaded,{session:e.session,user:e.user,organization:e.organization,client:e.client},n));d([z],e=>e.user);var W=d([z],e=>e.session),Y=d([z],e=>e.organization),S=d([T],e=>e.client),X=d([x],e=>e);d([S],e=>e?.sessions);var B=d([S],e=>e?.signIn),G=d([S],e=>e?.signUp),L=(e,n)=>{A(e,()=>{x.get()?.telemetry?.record(P(n))})};L(B,"$signInStore");L(G,"$signUpStore");L(Y,"$organizationStore");export{z as $,J as a,W as b,x as c,T as d,X as e,q as f};
